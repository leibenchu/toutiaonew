"use strict";(self["webpackChunktoutiao_m"]=self["webpackChunktoutiao_m"]||[]).push([[941],{3931:function(t,e,a){a.r(e),a.d(e,{default:function(){return L}});var s=function(){var t=this,e=t._self._c;return e("div",{staticClass:"home-container"},[e("van-nav-bar",{attrs:{fixed:""}},[e("van-button",{staticClass:"search-btn",attrs:{slot:"title",round:"",type:"info",size:"small",icon:"search"},slot:"title"},[t._v(" 搜索")])],1),e("van-tabs",{staticClass:"channel-tabs",attrs:{animated:"",swipeable:""},on:{click:t.tbn},model:{value:t.active,callback:function(e){t.active=e},expression:"active"}},[t._l(t.channels,(function(t){return e("van-tab",{key:t.id,attrs:{title:t.name}},[e("article-list-vue",{attrs:{channel:t}})],1)})),e("div",{staticClass:"placeholder",attrs:{slot:"nav-right"},slot:"nav-right"}),e("div",{staticClass:"hamburger-btn",attrs:{slot:"nav-right"},slot:"nav-right"},[e("i",{staticClass:"toutiao toutiao-gengduo"})])],2)],1)},i=[],n=(a(8146),a(8848)),l=function(){var t=this,e=t._self._c;return e("div",{staticClass:"article-list"},[e("van-pull-refresh",{attrs:{"success-text":t.text},on:{refresh:t.onRefresh},model:{value:t.isLoading,callback:function(e){t.isLoading=e},expression:"isLoading"}},[e("van-list",{attrs:{finished:t.finished,"finished-text":"没有更多了",error:t.error,"error-text":"请求失败，点击重新加载"},on:{load:t.onLoad,"update:error":function(e){t.error=e}},model:{value:t.loading,callback:function(e){t.loading=e},expression:"loading"}},t._l(t.list,(function(t,a){return e("ArticleItem",{key:a,attrs:{article:t}})})),1)],1)],1)},r=[],o=(a(541),a(435));const c=t=>(0,o.Z)({url:"/v1_0/articles",method:"GET",params:t});var d=function(){var t=this,e=t._self._c;return e("van-cell",{staticClass:"article-item"},[e("div",{staticClass:"title van-multi-ellipsis--l2",attrs:{slot:"title"},slot:"title"},[t._v(" "+t._s(t.article.title)+" ")]),1===t.article.cover.type?e("div",{attrs:{slot:"default"},slot:"default"},[e("van-image",{staticClass:"right-cover",attrs:{src:t.article.cover.images[0],fit:"cover"}})],1):t._e(),e("div",{attrs:{slot:"label"},slot:"label"},[3===t.article.cover.type?e("div",{staticClass:"cover-wrap"},t._l(t.article.cover.images,(function(t,a){return e("div",{key:a,staticClass:"cover-item"},[e("van-image",{staticClass:"cover-item-image",attrs:{fit:"cover",src:t}})],1)})),0):t._e(),e("div",{staticClass:"label-info-wrap"},[e("span",[t._v(t._s(t.article.aut_name))]),e("span",[t._v(t._s(t.article.comm_count)+"评论")]),e("span",[t._v(t._s(t._f("relativeTime")(t.article.pubdate)))])])])])},u=[],h={name:"ArticleItem",props:{article:{type:Object,required:!0}},data(){return{}},components:{},computed:{},mounted(){},created(){},updated(){},methods:{}},m=h,v=a(1001),p=(0,v.Z)(m,d,u,!1,null,"38503485",null),f=p.exports,g={name:"ArticleList",props:{channel:{type:Object,required:!0}},data(){return{list:[],loading:!1,finished:!1,timestamp:Date.now(),error:!1,isLoading:!1,text:""}},components:{ArticleItem:f},computed:{},mounted(){},created(){},updated(){},methods:{async onRefresh(){try{const{data:t}=await c({channel_id:this.channel.id,timestamp:Date.now()}),e=t.data.results,{results:a}=t.data;console.log("刷新"),this.list.unshift(...e),this.text=`刷新成功 刷新了${a.length}条数据`,this.isLoading=!1}catch(t){this.text="刷新失败",this.isLoading=!1}},async onLoad(){try{const{data:t}=await c({channel_id:this.channel.id,timestamp:this.timestamp}),e=t.data.results,a=t.data.pre_timestamp;this.timestamp=a,this.list=[...this.list,...e],console.log(this.list),0===e.length&&(this.finished=!0)}catch(t){this.error=!0,this.loading=!1}this.loading=!1}}},_=g,b=(0,v.Z)(_,l,r,!1,null,"535e3fc6",null),C=b.exports,x=a(2900),y={name:"home",data(){return{active:2,channels:[]}},components:{articleListVue:C},computed:{},mounted(){},created(){this.loadChannels()},updated(){},methods:{async loadChannels(){try{const t=await(0,x.Ff)();this.channels=t.data.data.channels}catch(t){console.log("导入频道出错"),(0,n.Z)("获取频道失败")}},tbn(t){console.log(t),console.log(this.active)}}},k=y,w=(0,v.Z)(k,s,i,!1,null,"1fc8050b",null),L=w.exports}}]);
//# sourceMappingURL=941.a0f9cf00.js.map